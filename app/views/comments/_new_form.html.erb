<script>
  $(document).ready(function() {
    function showTopic(el) {
      $(".comment-topic").each(function(ind, el) {
        $(el).css("display", "none")
      })
      $(".comment-area").show();
      $(".comment-" + el.value).show();
    }
    window.showTopic = showTopic
  });
</script>

<div>
  <%= form_with model: @comment, url: {action: "create"}, html: {class: "nifty_form"} do |f| %>

  <% if @parent_vote %>
  <%= hidden_field_tag :parent_vote, @parent_vote.public_token %>
  <% end %>

  <div class="mb-5">
    <p class="lead"><%= _("We suggest the United Nations presents a global initiative for a redeployment of the worldâ€™s armed forces into the new significant environmental tasks as soon as possible.") %></p>
    <div class="mb-3">
      <%= f.label :name, _("Name (*)") %>
      <%= f.text_field :name, :class => "form-control", :placeholder => _("Your name") %>
    </div>
    <div class="mb-3">
      <%= f.label :email, _("Email (*)") %>
      <%= f.text_field :email, :class => "form-control", :placeholder => _("Your email") %>
    </div>
    <div class="mb-3">
      <%= f.label :email_repeat, _("Email Confirmation (*)") %>
      <%= f.text_field :email_repeat, :class => "form-control", :placeholder => _("Repeat your email") %>
    </div>
    <div class="mb-3">
      <%= f.label :country, _("Country (*)") %>
      <%= f.select :country, options_for_select([["", "", {:selected => true, :disabled => true, :hidden => true}]] + Country.for_select, country_code), {}, :class => "form-control" %>
    </div>
    <div class="mb-3">
      <div class="g-recaptcha" data-sitekey="<%= UNITE_RECAPTCHA_PUBLIC_KEY %>"></div>
    </div>
    <p class="text-start">
      <%= f.submit _("Send"), :class => "btn btn-primary" %>
    </p>
    <p><%= _("You can also contribute to the discussion after signing. You will get a separate message of that by email.") %></p>
  </div>
  <% end %>
</div>

<%= form_with model: @comment, html: {class: "nifty_form"} do |f| %>
<div class="p-3 bg-white border rounded">
  <h3 class="pb-3"><%= _("Leave a comment") %></h3>
  <% if @comment.errors.any? %>
  <div id="error_explanation">
    <h2>
      <%= pluralize(@comment.errors.count, "error") %> prohibited this comment from being saved:
    </h2>
    <ul>
      <% @comment.errors.full_messages.each do |message| %>
      <li><%= message %></li>
      <% end %>
    </ul>
  </div>
  <% end %>

  <div class="mb-3">
    <%= f.label :language, _("Choose the language"), class: "ufs-1-5" %><br>
    <%= f.select(:language, Language.translated_select_options, {}, class: "form-control") %>
  </div>

  <div class="mb-3 text-start form-check">
    <div class="ufs-1-5"><%= _("Choose the topic") %></div>
    <% comment_topics.keys.each do |topic| %>
    <div>
      <%= f.radio_button(topic, "", onChange: "showTopic(this)", id: "comment_#{topic}", checked: false) %>
      <%= f.label topic, comment_topics[topic][:header], class: "form-check-label" %>
    </div>
    <% end %>
  </div>

  <div class="comment-area mb-3">
    <% comment_topics.keys.each do |topic| %>
    <div class="comment-topic comment-<%= topic %>">
      <h1 class="page-header"><%= comment_topics[topic][:header] %></h1>
      <%= image_tag("#{topic}.jpg", :class => "img-responsive img-rounded") %>
      <p class="lead">
        <%= comment_topics[topic][:description] %>
      </p>
    </div>
    <% end %>

    <br style="clear:both" />

    <div class="mb-3">
      <%= @vote.name %> (<%= @vote.email %>)
    </div>
    <div class="mb-3">
      <%= f.label :body, _('Comment (max 1000 characters)') %><br>
      <%= f.text_area :body, :class => "form-control" %>
    </div>
    <div class="mb-3">
      <div class="g-recaptcha" data-sitekey="6LfwgBQTAAAAAJrdJfpdvnMhibW4iUFJRdlK0ZXb"></div>
    </div>
    <div class="mb-3">
      <%= f.submit _("Add"), :class => "btn btn-primary form-control" %>
    </div>
  </div>

</div>
<% end %>